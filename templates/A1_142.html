<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <!--自适应框架CSS-->
    <!--<link rel="stylesheet" href="css/bootstrap.css">-->
    <!--JQueryUI CSS库-->
    <link rel="stylesheet" href="/static/css/jquery-ui.min.css">
    <!--threejs库-->
    <script src="/static/js/three.js"></script>
    <!--threejs控制器库-->
    <script src="/static/js/OrbitControls.js"></script>
    <!--JQuery框架-->
    <script src="/static/js/jquery-3.2.1.min.js"></script>
    <!--自适应框架-->
    <!--<script src="js/bootstrap.js"></script>-->
    <!--threejs obj载入库-->
    <script src="/static/js/OBJLoader.js"></script>
    <!--threejs状态栏库-->
    <!--<script src="js/stats.min.js"></script>-->
    <!--threejs mtl载入库-->
    <script src="/static/js/MTLLoader.js"></script>
    <!--JQueryUI库-->
    <script src="/static/js/jquery-ui.min.js"></script>
    <title>格调松间A1 ·142户型</title>
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        /*加载界面样式*/

        #Loading {
            background-image: url('/static/imgs/A1_142/loading.jpg');
            height: 100%;
            width: 100%;
            background-size: 100% 100%;
            position: absolute;
            z-index: 100;
        }

        /*进度条样式*/

        .divprogressbar {
            position: absolute;
            top: 45%;
            width: 100%;
            height: 50px;
            background-color: transparent;
        }

        #progressbar {
            position: absolute;
            top: 3%;
            width: 70%;
            height: 8px;
            margin: 0px 15% auto 15%;
            background-color: transparent;
        }

        .progress-text {
            position: absolute;
            top: 20px;
            width: 100%;
            height: 40px;
            /*left: 40%;*/
            background-color: transparent;
            font-family: 微软雅黑;
            font-size: 18px;
            text-align: center;
        }

        /*帮助页面样式*/

        .Help {
            background-image: url("/static/imgs/new/help.png");
            height: 100%;
            width: 100%;
            background-size: 100% 100%;
            opacity: 0.7;
            z-index: 20;
            position: absolute;
        }
        .thirdhelp{
            background-image: url("/static/imgs/A1_142/third_remind.png");
            height: 100%;
            width: 100%;
            background-size: 100% 100%;
            opacity: 0.7;
            display:none;
            z-index: 18;
            position: absolute;
        }
        /*主界面样式*/

        .Main {
            background-image: url("/static/imgs/A1_142/main_background.jpg");
            height: 100%;
            width: 100%;
            background-size: 100% 100%;
            /*position: absolute;*/
            /*如果是绝对定位会盖住模型*/
            z-index: 15;
        }
        .notice{
            background-image: url("/static/imgs/A1_142/second_remind.png");
            height: 100%;
            width: 100%;
            background-size: 100% 100%;
            display: none;
            z-index: 17;
            position:absolute;
        }

        .LightImage {
            background-image: url("/static/imgs/A1_142/light0.png");
            height: 100%;
            width: 100%;
            background-size: 100% 100%;
            display: none;
            position: absolute;
            /*z-index: 17;*/
        }

        /*户型标签*/

        .TypeTable {
            background-image: url("/static/imgs/first_name_1.png");
            height: 10%;
            top: 23%;
            width: 16%;
            left: 9%;
            position: absolute;
            background-size: 100% 100%;
        }

        /*户型简介*/

        .TypeSynopsis {
            background-image: url("/static/imgs/A1_142/first_introduce.png");
            height: 15.56%;
            top: 11.29%;
            width: 63.5%;
            position: absolute;
            background-size: 100% 100%;
        }

        /*户型简介详细*/

        .TypeSynopsisTableDetail {
            background-image: url("/static/imgs/first_move_2.png");
            height: 3.5%;
            top: 21.5%;
            width: 30%;
            position: absolute;
            background-size: 100% 100%;
        }

        /*视频样式*/

        .video {
            top: 35%;
            width: 100%;
            height: 40%;
            z-index: 2;
            display: none;
            position: absolute;
        }

        .house {
            margin-top: 46.94%;
            margin-left: 20.74%;
            width: 64.26%;
            height: 38.71%;
            display: none;
            position: absolute;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
        }

        .Row {
            width: 100%;
            /*height: 35.71%;*/
            height: 37.97%;
            display: flex;
            flex-direction: row;
            box-sizing: border-box;
            padding: 0 29.17%;
            justify-content: space-between;
            position: absolute;
            /*top: 29.14%;*/
            /*left: 0;*/
        }

        /*尺寸按钮样式*/

        .SizeButton {
            width: 31.1%;
            height: 100%;
            /*margin-left: 20%;*/
            /*background-image: url('imgs/first_buttonsize_down.png');*/
            /*background-size: 100% 100%;*/
            /*display: none;*/
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
        }

        /*下方功能区样式*/

        .Fun {
            width: 100%;
            position: absolute;
            bottom: 1px;
            height: 25.7%;
            text-align: center;
            /*z-index: 7;*/
        }

        /*功能选择区*/

        .Check {
            height: 58.9%;
            padding-top: 7.7%;
            position: relative;
        }

        /*按钮区域样式*/

        /*.ButtonArea {*/

        /*text-align: center;*/

        /*height: 60px;*/

        /*display: none;*/

        /*}*/

        .Button {
            /*margin-top: 10px;*/
            /*width: 50px;*/
            /*height: 50px;*/
            /*background-size: 50px 50px;*/
            /*text-align: center;*/
            /*display: none;*/
            width: 31.1%;
            height: 100%;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
        }

        /*功能切换区*/

        .Bar {
            /*margin-top: 20px;*/
            height: 18%;
            display: flex;
            flex-direction: row;
            justify-content: center;
        }

        .Select {
            height: 100%;
            width: 5.5%;
            /*margin-top: 20px;*/
            /*display: inline-block;*/
            /*border-radius: 100%;*/
            /*background:transparent;*/
            /*opacity: .2;*/
            background-image: url("/static/imgs/new/point_small.png");
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            /*text-align: center;*/
            /*margin-left: 30.56%;*/
        }

        .Selected {
            /*width: 2%;*/
            /*height: 100%;*/
            background-image: url("/static/imgs/new/point_big.png");
            /*background-size: contain;*/
            /*background-repeat: no-repeat;*/
            /*background-position: center;*/
        }

        #question {
            display: none;
            width: 52.96%;
            background-image: url("/static/imgs/new/forth_question.png");
            height: 3.39%;
            top: 46.49%;
            left: 23.51%;
            position: absolute;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
        }

        #form {
            display: none;
            top: 36.69%;
            width: 71.2%;
            height: 27.01%;
            left: 14.81%;
            top: 36.69%;
            position: absolute;
        }

        /*向左按钮*/

        .LeftButton {
            background-image: url("/static/imgs/new/left.png");
            /*position: absolute;*/
            /*top:50%;*/
            width: 8.3%;
            height: 100%;
            /*margin-top: 9px;*/
            /*margin-left: 30.56%;*/
            background-size: cover;
            background-repeat: no-repeat;
            background-position: center;
        }

        /*向右按钮*/

        .RightButton {
            background-image: url("/static/imgs/new/right.png");
            /*background-repeat: no-repeat ;*/
            /*position: absolute;*/
            /*top:50%;*/
            width: 8.3%;
            height: 100%;
            /*margin-top: 9px;*/
            /*margin-left: 70% -33px;*/
            /*padding-right: 100px;*/
            background-size: cover;
            background-repeat: no-repeat;
            background-position: center;
        }
    </style>
    <!--<script type="text/javascript">-->
    <!--var designWidth = 1080;-->

    <!--function resize(){-->

    <!--var width = document.documentElement.clientWidth;-->
    <!--var fontSize = (width/designWidth)*150;-->

    <!--document.documentElement.style.fontSize = fontSize + "px";-->
    <!--}-->

    <!--resize();-->

    <!--window.onresize = resize;-->
    <!--</script>-->
</head>

<body style="height:100%">
    <div id="Loading">
        <!--加载页面-->
        <div class="divprogressbar">
            <div id="progressbar"></div>
            <!--进度条-->
            <div class="progress-text"></div>
        </div>
    </div>
    <div class="Help" onclick="disshowhelp()"></div>
    <div class="thirdhelp" onclick=" $('.thirdhelp').hide();"></div>
    <div class="notice"></div>
    <div class="Main"  >
        <!--主界面-->
        
        <div id="house_1" class="house" style="background-image: url('/static/imgs/A1_142/forth_house_2.png');"></div>
        <div id="house_2" class="house" style="background-image: url('/static/imgs/A1_142/forth_house_3.png');"></div>
        <div id="house_3" class="house" style="background-image: url('/static/imgs/A1_142/forth_house_4.png');"></div>
        <div id="success" class="house" style="background-image: url('/static/imgs/new/submit_back.png');"></div>
        <div id="question"></div>
        <!--问题图片-->
        <!--户型亮点说明图-->
        <div class="LightImage"></div>
        <div id="form">
            <div id="hint" style="left:4.16%;width:94.79%;height:25.79%;position:absolute;background-image: url('/static/imgs/new/forth_word.png');background-size: contain;background-repeat: no-repeat;background-position:center"></div>
            <div style="top:33.9%;width:12.48%;height:20.46%;position:absolute;background-image: url('/static/imgs/new/forth_name.png');background-size: contain;background-repeat: no-repeat;"></div>
            <input type="text" id='name' style="top:33.9%;width:84.39%;height:18.55%;left:15.6%;position:absolute;text-align: center;border-radius: 15px;border:0.5px solid"
                onclick="this.focus()" />
            <div style="top:57.35%;width:12.48%;height:20.46%;position:absolute;background-image: url('/static/imgs/new/forth_phone.png');background-size: contain;background-repeat: no-repeat;"></div>
            <input type="text" id='phone' style="top:57.35%;width:84.39%;height:18.55%;left:15.6%;position:absolute;text-align:center;border-radius: 15px;border:0.5px solid"
                onclick="this.focus()" onkeyup="patten()" />
            <div style="top:79.53%;width:12.48%;height:20.46%;position:absolute;background-image: url('/static/imgs/new/forth_email.png');background-size: contain;background-repeat: no-repeat;"></div>
            <input type="text" id='email' style="top:79.53%;width:84.39%;height:18.55%;left:15.6%;position:absolute;text-align:center;border-radius: 15px;border:0.5px solid"
                onclick="this.focus()" />

        </div>
        <!--<div class="TypeTable"></div>&lt;!&ndash;户型标签&ndash;&gt;-->
        <div id="move1" class="TypeSynopsis"></div>
        <!--户型简介标签-->
        <!--<div id="move2" class="TypeSynopsisTableDetail"></div>&lt;!&ndash;户型简介详细标签&ndash;&gt;-->
        <div id="model"></div>
        <!--模型层-->
        <div class="Fun">
            <!--下方功能区-->
            <div class="Bar">
                <!--<div class="col-xs-4" style="height: 100%">-->
                <div type="button" class="LeftButton" id="left" onclick="select('left')"></div>
                <!--</div>-->
                <!--<div class="col-xs-4">-->
                <div class="Select Selected"></div>
                <div class="Select"></div>
                <div class="Select"></div>
                <div class="Select"></div>
                <!--</div>-->
                <!--<div class="col-xs-4">-->
                <div type="button" class="RightButton" id="right" onclick="select('right')"></div>
                <!--</div>-->
            </div>
            <div class="Check">
                <div class="Row" id="first">
                    <div id="size" class="SizeButton " style="background-image: url('/static/imgs/new/first_plane_up.png');" onclick='positionDefault()'></div>
                    <!--顶视图-->
                    <div id="plane" class="SizeButton " style="background-image: url('/static/imgs/new/first_clipping_up.png')" onclick='changePlane()'></div>
                    <!--改变Plane-->
                </div>
                <div class="Row " id="timebutton" style="display: none">
                    <audio id="moveaudio" preload="auto" src="/static/audio/A1_142.mp3"></audio>
                    <!--<audio id="moveaudio_1" preload="auto" src="audio/new/2.mp3"></audio>-->
                    <!--<audio id="moveaudio_2" preload="auto" src="audio/new/3.mp3"></audio>-->
                    <!--<audio id="moveaudio_3" preload="auto" src="audio/new/4.mp3"></audio>-->
                    <!--<audio id="moveaudio_4" preload="auto" src="audio/new/5.mp3"></audio>-->
                    <!--<div id="move" class="Button"-->
                    <!--style="background-image: url('imgs/new/first_plane_up.png');"-->
                    <!--onclick="positionDefault()"></div>&lt;!&ndash;顶视图按钮&ndash;&gt;-->
                    <div id="dingshitu" class="Button" style="background-image: url('/static/imgs/new/second_bright_up.png');margin-left: 35%;"
                        onclick="videomaterialmoving('#moveaudio',point['default'])"></div>
                    <!--移动镜头与控制器-->
                    <!--<div id="weishengjian" class="Button"-->
                    <!--style="background-image: url('imgs/second_wei_up.png');"-->
                    <!--onclick="moveTarget('weishengjian')"></div>&lt;!&ndash;卫生间按钮&ndash;&gt;-->
                    <!--<div id="zhuwo" class="col-xs-3 Button"-->
                    <!--style="background-image: url('imgs/second_wo_up.png');margin-left: 35px;display: none"-->
                    <!--onclick="moveTarget('zhuwo')"></div>&lt;!&ndash;主卧按钮&ndash;&gt;-->
                </div>
                <div class="Row " id="matbutton" style="display: none">
                    <div id="4_3" class="Button" style="background-image:url('/static/imgs/new/first_plane_up.png');" onclick="showMaterials('4_3')"></div>
                    <!--顶视图按钮-->
                    <div id="plane1" class="SizeButton " style="background-image: url('/static/imgs/new/first_clipping_up.png')" onclick="showMaterials('4_4')"></div>
                    <!--改变Plane-->
                    <!--<div id="4_1" class="Button"-->
                    <!--style="background-image: url('imgs/new/third_basic_up.png');"-->
                    <!--onclick="showMaterials('4_1')"></div>&lt;!&ndash;默认材质&ndash;&gt;-->
                    <!--<div id="4_2" class="Button"-->
                    <!--style="background-image: url('imgs/new/third_modify_up.png')"-->
                    <!--onclick="showMaterials('4_2')"></div>&lt;!&ndash;4_2材质&ndash;&gt;-->
                    <!--<div id="4_4" class="col-xs-3 Button"-->
                    <!--style="background-image: url('imgs/third_five_up.png');margin-left: 35px"-->
                    <!--onclick="pause()"></div>&lt;!&ndash;主卧按钮&ndash;&gt;-->
                </div>
                <div class="Row" id="forth" style="display: none">
                    <div id="satisfied" class="Button" style="background-image: url('/static/imgs/new/forth_satisfaction_up.png');" onclick="satisfaction()"></div>
                    <!--满意按钮-->
                    <div id="modify" class="Button" style="background-image: url('/static/imgs/new/third_modify_up.png');" onclick="changemodify()"></div>
                    <!--爆改户型-->
                </div>
                <div id="submit" style="display:none;left:33.33%;width:34.34%;height:45.05%;position:absolute;background-image: url('/static/imgs/new/forth_submit_up.png');background-size: contain;background-repeat: no-repeat;background-position:center"
                    onclick="addmessage()"></div>
            </div>


        </div>
    </div>
    <script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan style='display:none;' id='cnzz_stat_icon_1273038767'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s22.cnzz.com/z_stat.php%3Fid%3D1273038767%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));</script>
    <script type="text/javascript">
        //    var stats;//状态栏
        var containner;//绘制层
        var scene;//画板
        var camera;//相机
        var controls;//控制器
        var renderer;//渲染器
        var texture;//物料集
        var optimeout;//首页渐变的时钟
        var sizetimeout;//显示尺寸渐变时钟
        var movetimeout;//对焦点移动的时钟
        var materialtimeout;//切换物料的时钟
        var obj;//模型
        var plane//plane块
        var modify = 1;
        var materialsnames = {
            'default': ['1_jiaju_1', '1_jiaju_2', '1_jiaju_3', '1_qiangti','1_jiaju_4'],
            '4_2': ['2_jiaju_1', '2_jiaju_2', '2_jiaju_3', '2_qiangti'],
            '4_1': ['1_jiaju_1', '1_jaiju_2', '1_jiaju_3', '1_qiangti','1_jiaju_4']
        };
        var point = {
            //        'default': [{
            //            'control': new THREE.Vector3(-20, 0, 19),
            //            'camera': new THREE.Vector3(-20, 216, 19)
            //        },
            //            {
            //                'control': new THREE.Vector3(-51, -4, 19),
            //                'camera': new THREE.Vector3(-51, 127, 49)
            //            },
            //            {
            //                'control': new THREE.Vector3(36, -4, 15),
            //                'camera': new THREE.Vector3(36, 159, 52)
            //            },
            //            {
            //                'control': new THREE.Vector3(21, 6, -31),
            //                'camera': new THREE.Vector3(21, 132, -3)
            //            },
            //            {
            //                'control': new THREE.Vector3(0, 0, 0),
            //                'camera': new THREE.Vector3(0, 265, 0)
            //            }
            //        ]
            'default': [{
                'control': new THREE.Vector3(34, 9, -10),
                'camera': new THREE.Vector3(35, 98, 34)
            },
            {
                'control': new THREE.Vector3(32, -2, 14),
                'camera': new THREE.Vector3(32, 156, 66)
            },
            {
                'control': new THREE.Vector3(33, 0, 13),
                'camera': new THREE.Vector3(0, 103, 54)
            },
            {
                'control': new THREE.Vector3(21, 5, -25),
                'camera': new THREE.Vector3(21, 104, -12)
            },
            {
                'control': new THREE.Vector3(-2, 1, -28),
                'camera': new THREE.Vector3(-2, 102, -4)
            },
            {
                'control': new THREE.Vector3(-23, 6, -31),
                'camera': new THREE.Vector3(-1, 102, -16)
            },
            {
                'control': new THREE.Vector3(-44, -2, 7),
                'camera': new THREE.Vector3(-44, 166, 29)
            },
            {
                'control': new THREE.Vector3(0, 0, 0),
                'camera': new THREE.Vector3(0, 265, 0)
            }
            ]
        };
        var material = ['1_jiaju_1', '1_jiaju_2', '1_jiaju_3', '1_qiangti',
            '2_jiaju_1', '2_jiaju_2', '2_jiaju_3', '2_qiangti','1_jiaju_4'
        ];
        initProgressbar();//初始化进度条
        var selected = 1;//当前被选中的功能区页
        var buttontime;//当前被选中的时间按钮
        //    var spriteMapke = new THREE.TextureLoader().load("imgs/second_sprite_ke.png");
        //    var spriteMapchu = new THREE.TextureLoader().load("imgs/second_sprite_chu.png");
        //    var spriteMapwei = new THREE.TextureLoader().load("imgs/second_sprite_wei.png");
        //    var spriteMapwo = new THREE.TextureLoader().load("imgs/second_sprite_wo.png");
        //测试sprite
        //    var spriteMaterial = new THREE.SpriteMaterial({map: spriteMapke, color: 0xffffff});
        //    var sprite = new THREE.Sprite(spriteMaterial);
        //    console.log(sprite['material'].map);
        var buttonmove;//当前被选中的点位按钮
        //初始化户型简介 以及户型简介详细标签
        $('.TypeSynopsis').css('left', $(window).width());
        $('.TypeSynopsisTableDetail').css('left', $(window).width());
        $('.Main').hide();
        $('.Help').hide();
        initProgressbar();//初始化进度条
        init();//初始化模型状态
        animate();//实时更新模型状态
        var temptimeout;
        $('.Main').on('touchstart',function(){
            if(!tempstatus){
                $('.notice').show();
                if(temptimeout==undefined){
                    setTimeout(function(){
                    $('.notice').hide();
                },3000);
                }                
            }
        })
        //初始化模型
        function init() {
            //声明画板
            scene = new THREE.Scene();
            //声明渲染器
            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });//antialias:true是否启用抗锯齿
            renderer.setPixelRatio(window.devicePixelRatio);
            renderer.setSize(window.innerWidth, (window.innerHeight - 5) * 0.9);
            renderer.localClippingEnabled = true;//开启clipping
            
            //声明绘制层
            containner = document.createElement('div');
            containner.style.paddingTop = $(window).height() * 0.1 + 'px';
            //        containner.style.height = 100%;
            //将绘制层添加到模型层
            $('#model').append(containner);
            //设置模型层高度
            $('#model').height($(window).height());
            //向绘制层添加渲染结果
            containner.appendChild(renderer.domElement);
            //相机
            camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 1, 2000);
            camera.position.y = 185;//相机Y坐标为100
            camera.position.z = 197;//相机Z坐标为300
            camera.position.x = 0;
            //为相机添加控制器
            controls = new THREE.OrbitControls(camera);
            //监听控制器改变函数运行方法render
            controls.addEventListener('change', render);
            //创建Plane
            plane = new THREE.Plane(new THREE.Vector3(0, -1, 0), 36);
            //控制器启动自动旋转
            controls.autoRotate = true;
            //光线设置
            var directionalLight = new THREE.DirectionalLight(0xFFFFFF, 1.1);//定向光
            //定向光位置设置
            directionalLight.position.set(56, 75, -134);
            //向画板中添加定向光
            scene.add(directionalLight);
            //第二个定向光
            var light1 = new THREE.DirectionalLight(0xFFFFFF, 1.2);
            light1.position.set(-75, 39, 75);
            scene.add(light1);
            //环境光
            var light2 = new THREE.AmbientLight(0xFFFFFF);//环境光
            //向画板添加环境光
            scene.add(light2);
            //        sprite.visible = false;
            //        sprite.position.x=-60;
            //        sprite.scale.x = 40;
            //        sprite.scale.y = 40;
            //        sprite.scale.z = 40;
            //        scene.add(sprite);
            //        console.log(sprite);
            //声明载入过程函数以及载入失败函数
            var progressbar = $("#progressbar");//进度条
            var onProgress = function (xhr) {
                if (xhr.lengthComputable) {
                    var percentComplete = xhr.loaded / xhr.total * 100;//完成进度的百分比
                    progressbar.progressbar("value", Math.round(percentComplete, 2));//设置进度条已完成的半分比数字
                }
            };
            //载入模型失败调用的函数(此函数暂时无法被调用)
            var onError = function (xhr) {
                console.log('error');
            };
            //载入模型与材质
            var mtlLoader = new THREE.MTLLoader();
            mtlLoader.setPath('/static/A1_142/');//mtl路径
            mtlLoader.load('A1_142.mtl', function (materials) {//载入mtl路径的哪个mtl文件
                materials.preload();//载入物料
                texture = materials;//将导入物料传给程序集变量
                materials['materials']['1_qiangti']['clippingPlanes'] = [plane];//设置将plane附着在哪个模型
                materials['materials']['1_jiaju_1']['clippingPlanes'] = [plane];
                materials['materials']['1_jiaju_2']['clippingPlanes'] = [plane];
                materials['materials']['1_jiaju_3']['clippingPlanes'] = [plane];
                materials['materials']['1_jiaju_4']['clippingPlanes'] = [plane];
                materials['materials']['1_qiangti']['clipShadows'] = true;//设置plane阴影启用
                console.log(materials);
                var objLoader = new THREE.OBJLoader();//声明obj载入对象
                objLoader.setMaterials(materials);//给obj模型设置物料
                objLoader.setPath('/static/A1_142/');//设置obj所在路径
                objLoader.load('A1_142.obj', function (object) {//载入obj
                    scene.add(object);//将obj添加到画板
                    obj = object;//将模型赋值程序集变量obj
                    console.log(obj);//调试输出模型
                    obj.scale.x = 2;//模型X轴缩放系数
                    obj.scale.y = 2;//模型Y轴缩放系数
                    obj.scale.z = 2;//模型Z轴缩放系数
                    // console.log(obj['children'][7]['material'])
                    // console.log(obj['children'][9]['material'])
                    // console.log(obj['children'][10]['material'])
                    obj['children'][7]['material'].color = new THREE.Color(0, 0, 0);
                    obj['children'][9]['material'].color = new THREE.Color(0, 0, 0);
                    obj['children'][10]['material'].color = new THREE.Color(0, 0, 0);
                    buttontime = 1;//当前时间按钮选中位置
                    //                    $('#keting').css('background-image', "url('imgs/second_ke_down.png')");//默认客厅按钮选中
                    //                    isAlltouming(false);
                    showMaterials('default');
                    optimeout = setInterval(opacity, 100);//首页渐变
                }, onProgress, onError);
            });
            //        stats = new Stats();
            //        stats.showPanel(2);
            //        containner.appendChild(stats.dom);
            window.addEventListener('resize', onWindowResize, false);//添加尺寸改变监听
        }

        function onWindowResize() {//屏幕尺寸改变调用函数
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        function animate() {//动画更新函数
            // console.log('----------controls---------');
            // console.log(controls.target);
            // console.log('==========camera===========');
            // console.log(camera.position);
            requestAnimationFrame(animate);
            controls.update();
            //        stats.update();
            render();

        }

        function render() {//控制器改变事件

            if (controls.getState() != -1) {//如果用户操作
                controls.autoRotate = false;//停止控制器自转
            }
            renderer.render(scene, camera);
        }

        //----------------------------------分割线以上是模型加载Threejs------------------------------------------------
        function opacity() {//渐变进入Main界面
            $('#Loading').css('opacity', $("#Loading").css('opacity') - 0.1);//Loading页面透明度减少0.1
            var opval = $('#Loading').css('opacity');//读取loading页面透明度
            if (opval <= 0) {
                //渐变结束
                clearInterval(optimeout);//清除渐变时钟
                $('#Loading').hide();//loading页面隐藏
                //初始化户型简介 以及户型简介详细标签
                pagename("url('/static/imgs/A1_142/first_introduce.png')");
            }
        }

        function initProgressbar() {//初始化进度条
            var progressbar = $("#progressbar"),
                progressLabel = $(".progress-text");

            progressbar.progressbar({
                value: false,
                change: function () {
                    progressLabel.text(progressbar.progressbar("value") + "%");
                },
                complete: function () {
                    // progressLabel.text("complete！");
                    $('.Main').show();
                    $('.Help').show();
                }
            });
        }

        //----------------------------------分割线以下是切换功能------------------------------------------------
        function select(orientation) {//切换功能区页   orientation为切换方向
            if (selected == 1 && orientation == 'right' && completechange && tempstatus) {//页面2
                //            pagename("url('imgs/second_pagename_1.png')", "url('imgs/first_move_2.png')");
                pagename("url('/static/imgs/A1_142/second_introduce.png')");
                controls.target = new THREE.Vector3();
                obj['children'][7].visible = false;//尺寸是否显示
                plane.constant = 36;//还原Plane
                $('#plane').css('background-image', "url('/static/imgs/new/first_clipping_up.png')");//设置Plane按钮为抬起状态
                //$('#plane1').css('background-image', "url('imgs/new/first_clipping_up.png')");//设置Plane按钮为抬起状态
                direction = 'up';//当前plane状态
                positionDefault();//顶视图
                $(".Select:eq(0)").removeClass('Selected');
                $(".Select:eq(1)").addClass('Selected');
                $(".Select:eq(2)").removeClass('Selected');
                $(".Select:eq(3)").removeClass('Selected');
                $('#first').hide();
                $('#forth').hide();
                $('#question').hide();
                //            $('.TypeTable').show();
                $('.TypeSynopsis').show();
                $('#timebutton').show();
                $('#matbutton').hide();
                $('#submit').hide();
                $('#form').hide();
                //            visiblesize = true;
                //            sprite.visible = false;
                //            isShowsize();
                clearTargetButton();
                //            buttonmove = 0;
                obj.visible = true;
                //            $('.video').attr('src', 'http://www.nuoyikeji.com');
                //            $('.video').hide();
                selected = 2;
                return;
            }
            if (selected == 1 && orientation == 'left' && completechange && tempstatus) {//页面4
                //            pagename("url('imgs/forth_pagename_1.png')", "url('imgs/first_move_2.png')");
                //            pagename("url('imgs/new/first_introduce.png')");
                $(".Select:eq(0)").removeClass('Selected');
                obj['children'][11].visible = false;
                plane.constant = 36;
                $('#plane').css('background-image', "url('/static/imgs/new/first_clipping_up.png')");
                //$('#plane1').css('background-image', "url('imgs/new/first_clipping_up.png')");//设置Plane按钮为抬起状态
                $('#modify').css('background-image', "url('/static/imgs/new/third_modify_up.png')");
                modify = 1;
                direction = 'down';
                //            $('#plane').
                $(".Select:eq(1)").removeClass('Selected');
                $(".Select:eq(2)").removeClass('Selected');
                $(".Select:eq(3)").addClass('Selected');
                $('#first').hide();
                $('#forth').show();
                $('#question').show();
                //            $('.TypeTable').hide();
                $('.TypeSynopsis').hide();
                $('#timebutton').hide();
                $('#matbutton').hide();
                $('#submit').hide();
                $('#form').hide();
                visiblesize = true;
                //            sprite.visible = false;
                //            isShowsize();
                obj.visible = false;
                //            $('.video').attr('src', 'https://v.qq.com/iframe/player.html?vid=d0173blwu1c&tiny=0&auto=0');
                //            $('.video').show();
                selected = 4;
                return;
            }
            if (selected == 2 && orientation == 'right' && completechange && tempstatus) {//页面3
                changemat = 0;
                //            pagename("url('imgs/third_pagename_1.png')", "url('imgs/first_move_2.png')");
                $('.thirdhelp').show();
                pagename("url('/static/imgs/A1_142/third_introduce.png')");
                camera.position.y = 265;//相机Y坐标为100
                camera.position.z = 0;//相机Z坐标为300
                camera.position.x = 0;
                controls.target = new THREE.Vector3();
                $(".Select:eq(0)").removeClass('Selected');
                $(".Select:eq(1)").removeClass('Selected');
                $(".Select:eq(2)").addClass('Selected');
                $(".Select:eq(3)").removeClass('Selected');
                $('.first').hide();
                $('#forth').hide();
                $('#question').hide();
                $('.TypeSynopsis').show();
                $('#timebutton').hide();
                $('#matbutton').show();
                $('#submit').hide();
                $('#form').hide();
                showMaterials('4_2');//切换模型材质
                //            $('.TypeTable').show();
                clearMatButton();
                //            visiblesize = true;
                //            sprite.visible = false;
                //            isShowsize();
                obj.visible = true;
                //            $('.video').attr('src', 'http://www.nuoyikeji.com');
                //            $('.video').hide();
                selected = 3;
                return;
            }
            if (selected == 2 && orientation == 'left' && completechange && tempstatus) {//页面1
                //            pagename("url('imgs/first_move_1.png')", "url('imgs/first_move_2.png')");
                $('.TypeSynopsis').show();
                pagename("url('/static/imgs/A1_142/first_introduce.png')");
                camera.position.y = 185;//相机Y坐标为100
                camera.position.z = 197;//相机Z坐标为300
                camera.position.x = 0;
                controls.target = new THREE.Vector3();
                $(".Select:eq(0)").addClass('Selected');
                $(".Select:eq(1)").removeClass('Selected');
                $(".Select:eq(2)").removeClass('Selected');
                $(".Select:eq(3)").removeClass('Selected');
                $('#first').show();
                $('#forth').hide();
                $('#question').hide();
                $('#timebutton').hide();
                $('#matbutton').hide();
                $('#submit').hide();
                $('#form').hide();
                //            $('.TypeTable').show();
                showMaterials('default');
                clearTargetButton();
                //            sprite.visible = false;
                //            visiblesize = true;
                //            isShowsize();
                obj.visible = true;
                //            $('.video').attr('src', 'http://www.nuoyikeji.com');
                //            $('.video').hide();
                selected = 1;
                return;
            }
            if (selected == 3 && orientation == 'right' && completechange && tempstatus) {//页面4
                //            pagename("url('imgs/forth_pagename_1.png')", "url('imgs/first_move_2.png')");
                //            pagename("url('imgs/new/first_introduce.png')");
                $('#modify').css('background-image', "url('/static/imgs/new/third_modify_up.png')");
                modify = 1;
                $(".Select:eq(0)").removeClass('Selected');
                $(".Select:eq(1)").removeClass('Selected');
                $(".Select:eq(2)").removeClass('Selected');
                $(".Select:eq(3)").addClass('Selected');
                $('#first').hide();
                $('#forth').show();
                $('#question').show();
                $('#timebutton').hide();
                $('#matbutton').hide();
                $('.TypeSynopsis').hide();
                $('#submit').hide();
                $('#form').hide();
                //            $('.TypeTable').hide();
                //            visiblesize = true;
                //            sprite.visible = false;
                //            isShowsize();
                obj.visible = false;
                //            $('.video').attr('src', 'https://v.qq.com/iframe/player.html?vid=d0173blwu1c&tiny=0&auto=0');
                //            $('.video').show();
                selected = 4;
                return;
            }
            if (selected == 3 && orientation == 'left' && completechange && tempstatus) {//页面2
                //            pagename("url('imgs/second_pagename_1.png')", "url('imgs/first_move_2.png')");
                pagename("url('/static/imgs/A1_142/second_introduce.png')");
                camera.position.x = 0;
                //            buttonmove = 0;
                camera.position.y = 265;//相机Y坐标为100
                camera.position.z = 0;//相机Z坐标为300
                
                controls.target = new THREE.Vector3();
                $(".Select:eq(0)").removeClass('Selected');
                $(".Select:eq(1)").addClass('Selected');
                $(".Select:eq(2)").removeClass('Selected');
                $(".Select:eq(3)").removeClass('Selected');
                $('#first').hide();
                $('#forth').hide();
                $('#question').hide();
                $('#timebutton').show();
                $('#matbutton').hide();
                $('.TypeSynopsis').show();
                $('#submit').hide();
                $('#form').hide();
                showMaterials('default');
                //            $('.TypeTable').show();
                clearTargetButton();
                obj['children'][7].visible = false;//尺寸是否显示
                //            visiblesize = true;
                //            sprite.visible = false;
                //            isShowsize();
                obj.visible = true;
                //            $('.video').attr('src', 'http://www.nuoyikeji.com');
                //            $('.video').hide();
                selected = 2;
                return;
            }
            if (selected == 4 && orientation == 'right' && completechange && tempstatus) {//页面1
                //            pagename("url('imgs/first_move_1.png')", "url('imgs/first_move_2.png')");
                $('.TypeSynopsis').show();
                clearhouse();
                pagename("url('/static/imgs/A1_142/first_introduce.png')");
                camera.position.y = 185;//相机Y坐标为100
                camera.position.z = 197;//相机Z坐标为300
                camera.position.x = 0;
                controls.target = new THREE.Vector3();
                $(".Select:eq(0)").addClass('Selected');
                $(".Select:eq(1)").removeClass('Selected');
                $(".Select:eq(2)").removeClass('Selected');
                $(".Select:eq(3)").removeClass('Selected');
                $('#first').show();
                $('#forth').hide();
                $('#question').hide();
                $('#timebutton').hide();
                $('#matbutton').hide();
                $('#submit').hide();
                $('#form').hide();
                //            $('.TypeTable').show();
                showMaterials('default');
                visiblesize = true;
                //            sprite.visible = false;
                //            isShowsize();
                obj.visible = true;
                //            $('.video').attr('src', 'http://www.nuoyikeji.com');
                //            $('.video').hide();
                selected = 1;
                return;
            }
            if (selected == 4 && orientation == 'left' && completechange && tempstatus) {//页面3
                //            pagename("url('imgs/third_pagename_1.png')", "url('imgs/first_move_2.png')");
                $('.thirdhelp').show();
                pagename("url('/static/imgs/A1_142/third_introduce.png')");
                camera.position.y = 265;//相机Y坐标为100
                camera.position.z = 0;//相机Z坐标为300
                camera.position.x = 0;
                controls.target = new THREE.Vector3();
                clearhouse();
                $(".Select:eq(0)").removeClass('Selected');
                $(".Select:eq(1)").removeClass('Selected');
                $(".Select:eq(2)").addClass('Selected');
                $(".Select:eq(3)").removeClass('Selected');
                $('#first').hide();
                $('#forth').hide();
                $('#question').hide();
                $('#timebutton').hide();
                $('#matbutton').show();
                $('.TypeSynopsis').show();
                $('#submit').hide();
                $('#form').hide();
                showMaterials('4_2');
                //            $('.TypeTable').show();
                //            visiblesize = true;
                clearMatButton();
                changemat = 0;
                //            sprite.visible = false;
                //            isShowsize();
                obj.visible = true;
                //            $('.video').attr('src', 'http://www.nuoyikeji.com');
                //            $('.video').hide();
                selected = 3;
                return;
            }
        }

        //----------------------------------分割线以下是功能函数------------------------------------------------
        function isShowsize() {//是否显示尺寸
            if (!visiblesize) {//visiblesize为false 显示尺寸
                texture['materials']['sice'].transparent = false;
                sizetimeout = setInterval(showsize, 100);
                visiblesize = true;
                $('.SizeButton').css('background-image', "url('/static/imgs/first_buttonsize_up.png')");
            }
            else {//清除尺寸
                clearInterval(sizetimeout);
                texture['materials']['sice'].transparent = true;
                texture['materials']['sice'].opacity = 0;
                visiblesize = false;
                $('.SizeButton').css('background-image', "url('/static/imgs/first_buttonsize_down.png')");
            }
        }

        function showsize() {//渐变显示尺寸
            texture['materials']['sice'].opacity = texture['materials']['sice'].opacity + 0.1;
            var sizeopacity = texture['materials']['sice'].opacity;
            if (sizeopacity >= 1) {
                clearInterval(sizetimeout);
            }
        }

        var changemat = 0;
        var completechange = true;
        var direction1 = 'up';
        var plane1 = new THREE.Plane(new THREE.Vector3(0, -1, 0), 36);

        function showMaterials(materialname) {
            //所有材质显示消失
            if (completechange && tempstatus) {

                if (materialname == 'default') {
                    clearMaterials();
                    clearMatButton();
                    completechange = false;

                    for (var v1 in materialsnames['default']) {
                        // console.log(materialsnames['default'][v1])
                        texture['materials'][materialsnames['default'][v1]].transparent = false;
                    }
                    obj['children'][7].visible = true;
                    materialtimeout = setInterval("showtimeMaterials(materialsnames['default'])", 100);
                }
                if (materialname == '4_1' && changemat != 2) {
                    clearMaterials();
                    clearMatButton();
                    completechange = false;
                    $('#4_1').css('background-image', "url('imgs/new/third_basic_down.png')");
                    for (var v2 in materialsnames['4_1']) {
                        texture['materials'][materialsnames['4_1'][v2]].transparent = false;
                    }
                    changemat = 2;
                    controls.enabled = false;
                    materialtimeout = setInterval("showtimeMaterials(materialsnames['4_1'],point['default'])", 100);
                }
                if (materialname == '4_2' && changemat != 3) {
                    clearMaterials();
                    clearMatButton();
                    completechange = false;
                    $('#4_2').css('background-image', "url('/static/imgs/new/third_modify_down.png')");
                    for (var v3 in materialsnames['4_2']) {
                        texture['materials'][materialsnames['4_2'][v3]].transparent = false;
                    }
                    texture['materials']['2_qiangti']['clippingPlanes'] = [plane1];//设置将plane附着在哪个模型
                    texture['materials']['2_jiaju_1']['clippingPlanes'] = [plane1];
                    texture['materials']['2_jiaju_2']['clippingPlanes'] = [plane1];
                    texture['materials']['2_jiaju_3']['clippingPlanes'] = [plane1];
                    texture['materials']['2_qiangti']['clipShadows'] = true;//设置plane阴影启用

                    plane1.constant = 36;
                    $('#plane1').css('background-image', "url('/static/imgs/new/first_clipping_up.png')");
                    direction1 = 'up';
                    // changemat = 3;
                    controls.enabled = false;

                    materialtimeout = setInterval("showtimeMaterials(materialsnames['4_2'],point['default'])", 100);

                    // console.log(texture);
                }
                if (materialname == '4_3' && changemat != 4) {
                    //                clearMaterials();
                    positionDefault();
                    clearMatButton();
                    // $('#4_3').css('background-image', "url('imgs/new/first_plane_down.png')");
                    //                completechange = false;
                    //                $('#4_3').css('background-image', "url('imgs/third_four_down.png')");
                    //                for (var v4 in materialsnames['4_3']) {
                    //                    texture['materials'][materialsnames['4_3'][v4]].transparent = false;
                    //                }
                    changemat = 4;
                    //                controls.enabled = false;
                    //                materialtimeout = setInterval("showtimeMaterials(materialsnames['4_3'])", 100);
                }
                if (materialname == '4_4' && changemat != 5) {
                    // clearMaterials();
                    clearMatButton();
                    // completechange = false;
                    // $('#4_4').css('background-image', "url('imgs/third_five_down.png')");
                    // for (var v5 in materialsnames['4_4']) {
                    //     texture['materials'][materialsnames['4_4'][v5]].transparent = false;
                    // }
                    var planetimeout1;

                    planetimeout1 = setInterval(function () {
                        if (direction1 == 'down') {
                            plane1.constant += 1;
                            if (plane1.constant >= 36) {
                                $('#plane1').css('background-image', "url('/static/imgs/new/first_clipping_up.png')");
                                direction1 = 'up';
                                clearInterval(planetimeout1);
                            }
                        }
                        if (direction1 == 'up') {
                            plane1.constant -= 1;
                            if (plane1.constant <= 10) {
                                $('#plane1').css('background-image', "url('/static/imgs/new/first_clipping_down.png')");
                                direction1 = 'down';
                                clearInterval(planetimeout1);
                            }
                        }
                    }, 10);
                    // changemat = 5;
                    // materialtimeout = setInterval("showtimeMaterials(materialsnames['4_4'])", 100);
                }
            }


        }

        function clearMaterials() {
            for (var i in material) {
                // console.log(texture['materials'][material[i]])
                texture['materials'][material[i]].transparent = true;
                texture['materials'][material[i]].opacity = 0;
            }
            obj['children'][7].visible = false;
            obj['children'][9].visible = false;
            obj['children'][10].visible = false;
        }

        function showtimeMaterials(tempmaterials, points) {

            for (var v in tempmaterials) {
                texture['materials'][tempmaterials[v]].opacity = texture['materials'][tempmaterials[v]].opacity + 0.1;
            }
     
            var stopopacity = texture['materials'][tempmaterials[tempmaterials.length - 1]].opacity;

            if (stopopacity >= 1) {
                //            if (tempmaterials !== materialsnames['default']) {
                //                videomaterialmoving('', points);
                //            }
                //            texture['materials'][tempmaterials[6]].transparent = true;
                //            texture['materials'][tempmaterials[6]].opacity = 0.5;
                controls.enabled = true;
                completechange = true;
                // console.log(texture);
                clearInterval(materialtimeout);

            }


        }

        function clearMatButton() {//清空对焦点按钮背景图片
            $('#4_1').css('background-image', "url('/static/imgs/new/third_basic_up.png')");
            $('#4_2').css('background-image', "url('/static/imgs/new/third_modify_up.png')");
            $('#4_3').css('background-image', "url('/static/imgs/new/first_plane_up.png')");
            //        $('#4_4').css('background-image', "url('imgs/third_five_up.png')");
        }

        var timeoutmove;
        var temptarget = false;
        var tempcamera = false;
        var tempstatus = true;//移动完成为真
        //    function moveTarget(position) {//移动对焦点
        //        if (tempstatus) {
        //            if (position == 'keting' && buttonmove !== 1) {
        //                sprite.visible = false;
        //                clearTargetButton();
        //                $('#keting').css('background-image', "url('imgs/second_ke_down.png')");
        //                sprite['material'].map = spriteMapke;
        //                sprite.position.x = -18;
        //                sprite.position.y = 25;
        //                sprite.position.z = 25;
        //                moveend = new THREE.Vector3(-40, 0, 25);
        //                cameraend = new THREE.Vector3(-93, 147, 140);
        //                tempstatus = false;
        //                movetimeout = setInterval('moving(controls.target,moveend,camera.position,cameraend)', 20);
        //                buttonmove = 1;
        //            }
        //            if (position == 'chufang' && buttonmove !== 2) {
        //                sprite.visible = false;
        //                clearTargetButton();
        //                $('#chufang').css('background-image', "url('imgs/second_chu_down.png')");
        //                sprite['material'].map = spriteMapchu;
        //                sprite.position.x = -20;
        //                sprite.position.y = 25;
        //                sprite.position.z = -30;
        //                moveend = new THREE.Vector3(-23, 0, -21);
        //                cameraend = new THREE.Vector3(-24, 141, 70);
        //                tempstatus = false;
        //                movetimeout = setInterval('moving(controls.target,moveend,camera.position,cameraend)', 20);
        //                buttonmove = 2;
        //            }
        //            if (position == 'weishengjian' && buttonmove !== 3) {
        //                sprite.visible = false;
        //                clearTargetButton();
        //                $('#weishengjian').css('background-image', "url('imgs/second_wei_down.png')");
        //                sprite['material'].map = spriteMapwei;
        //                sprite.position.x = 7;
        //                sprite.position.y = 25;
        //                sprite.position.z = -32;
        //                moveend = new THREE.Vector3(3, 0, -30);
        //                cameraend = new THREE.Vector3(1, 81, 33);
        //                tempstatus = false;
        //                movetimeout = setInterval('moving(controls.target,moveend,camera.position,cameraend)', 20);
        //                buttonmove = 3
        //            }
        //            if (position == 'zhuwo' && buttonmove !== 4) {
        //                sprite.visible = false;
        //                clearTargetButton();
        //                $('#zhuwo').css('background-image', "url('imgs/second_wo_down.png')");
        //                sprite['material'].map = spriteMapwo;
        //                sprite.position.x = 54;
        //                sprite.position.y = 25;
        //                sprite.position.z = 28;
        //                moveend = new THREE.Vector3(46, 0, 25);
        //                cameraend = new THREE.Vector3(0, 104, 38);
        //                tempstatus = false;
        //                movetimeout = setInterval('moving(controls.target,moveend,camera.position,cameraend)', 20);
        //                buttonmove = 4;
        //            }
        //        }
        //
        //
        //        temptarget = false;
        //        tempcamera = false;
        //    }

        function videomaterialmoving(audioID, point) {
            if (tempstatus) {
                camera.position.x = 0;
                //            buttonmove = 0;
                camera.position.y = 265;//相机Y坐标为100
                camera.position.z = 0;//相机Z坐标为300
                controls.target = new THREE.Vector3();
                $('#dingshitu').css('background-image', "url('/static/imgs/new/second_bright_down.png')");
                controls.enabled = false;
                tempstatus = false;
                if (audioID != '' && audioID) {
                    $(audioID)[0].play();
                }


                movingtargetcamera(point[0], 0); 

                obj['children'][10].visible = true;
                var index = 1;
                var end = parseInt(point.length) - 1;
                var timeoutZong = setInterval(function () {
                    for (var i = 1; i < point.length; i++) {
                        if (i == index) {
                            
                            //                        console.log(index);
                            if (index == 1) {
                                obj['children'][10].visible = false;
                                obj['children'][9].visible = true;
                            }
                            if (index ==2) {
                                //                            $(audioID + '_' + i)[0].play();//第五个点没有声音
                                obj['children'][10].visible = false;
                                obj['children'][9].visible = false;
                            }

                            movingtargetcamera(point[i], index);
                        }
                    }
                    //户型亮点循环一边
                    if (index >= point.length) {
                        if (index == point.length) {
                            
                            // $('.LightImage').css('background-image', "url('imgs/light" + index + ".png')");
                            $('.LightImage').hide();
                            $('#dingshitu').css('background-image', "url('/static/imgs/new/second_bright_up.png')");
                            controls.enabled = true;
                            tempstatus = true;
                        }
                        clearInterval(timeoutZong);
                    }
                    index++;
                }, 9000);
            }
        }

        function movingtargetcamera(item, number) {
            $('.LightImage').hide();
            temptarget = false;
            tempcamera = false;
            timeoutmove = setInterval(function () {//移动控制器以及摄像机
                if (!temptarget) {//移动控制器
                    if (controls.target.x < item['control'].x) {
                        controls.target.x = controls.target.x + 1;
                    }
                    else if (controls.target.x > item['control'].x) {
                        controls.target.x = controls.target.x - 1;
                    }
                    if (controls.target.y < item['control'].y) {
                        controls.target.y = controls.target.y + 1;
                    }
                    else if (controls.target.y > item['control'].y) {
                        controls.target.y = controls.target.y - 1;
                    }
                    if (controls.target.z < item['control'].z) {
                        controls.target.z = controls.target.z + 1;
                    }
                    else if (controls.target.z > item['control'].z) {
                        controls.target.z = controls.target.z - 1;
                    }
                }
                if (!tempcamera) {//移动摄像机
                    if (camera.position.round().x < item['camera'].x) {
                        camera.position.setX(camera.position.x + 1);
                    }
                    else if (camera.position.round().x > item['camera'].x) {
                        //                                camera.position.x = camera.position.x - 1;
                        camera.position.setX(camera.position.x - 1);
                    }
                    if (camera.position.round().y < item['camera'].y) {
                        //                                camera.position.y = camera.position.y + 1;
                        camera.position.setY(camera.position.y + 1);
                    }
                    else if (camera.position.round().y > item['camera'].y) {
                        //                                camera.position.y = camera.position.y - 1;
                        camera.position.setY(camera.position.y - 1);
                    }
                    if (camera.position.round().z < item['camera'].z) {
                        //                                camera.position.z = camera.position.z + 1;
                        camera.position.setZ(camera.position.z + 1);
                    }
                    else if (camera.position.round().z > item['camera'].z) {
                        //                                camera.position.z = camera.position.z - 1;
                        camera.position.setZ(camera.position.z - 1);
                    }
                }
                if (controls.target.x == item['control'].x && controls.target.y == item['control'].y && controls.target.z == item['control'].z) {
                    temptarget = true;
                }
                //            if (controls.target.x == item['control'].x && controls.target.y == item['control'].y) {
                //                temptarget = true;
                //            }
                if (camera.position.round().x == item['camera'].x && camera.position.round().y == item['camera'].y && camera.position.round().z == item['camera'].z) {
                    tempcamera = true;
                }
                //            if (camera.position.round().x == item['camera'].x && camera.position.round().y == item['camera'].y) {
                //                tempcamera = true;
                //            }
                if (temptarget && tempcamera) {
                    if (number != null) {
                        $('.LightImage').css('background-image', "url('/static/imgs/A1_142/light" + number + ".png')");
                        $('.LightImage').show();
                    }
                    //                tempstatus = true;
                    clearInterval(timeoutmove);
                }
            }, 15);
        }

        function getMaterialing() {//获取当前材质编号
            for (var key in texture['materials']) {
                var mattransparent = texture['materials'][key];
                if (!mattransparent.transparent) {
                    var matname = mattransparent['name'].split("_")[0];
                    if (matname == '1') {
                        return 'default';
                    }
                    if (matname == '2') {
                        return '4_1';
                    }
                    if (matname == '3') {
                        return '4_2';
                    }
                    if (matname == '4') {
                        return '4_3';
                    }
                    if (matname == '5') {
                        return '4_4';
                    }
                }
            }
        }

        function clearTargetButton() {//清空对焦点按钮背景图片
            $('#keting').css('background-image', "url('/static/imgs/second_ke_up.png')");
            $('#chufang').css('background-image', "url('/static/imgs/second_chu_up.png')");
            $('#weishengjian').css('background-image', "url('/static/imgs/second_wei_up.png')");
            $('#zhuwo').css('background-image', "url('/static/imgs/second_wo_up.png')");
        }

        function pagename(url1, url2) {
            $('.TypeSynopsis').css('left', $(window).width());
            //        $('.TypeSynopsisTableDetail').css('left', $(window).width());
            $('.TypeSynopsis').css('background-image', url1);
            //        $('.TypeSynopsisTableDetail').css('background-image', url2);
            $('.TypeSynopsis').animate({ left: $(window).width() - $('.TypeSynopsis').width() - 20 }, '400');//户型简介标签每个400毫秒向左移动显示

            //        setTimeout(function () {
            //            $('.TypeSynopsisTableDetail').animate({left: $(window).width() - $('.TypeSynopsisTableDetail').width()}, '400');//户型简介详细标签每个400毫秒向左移动显示
            //        }, 200);//200毫秒后执行户型简介详细标签移动
        }

        //位置复原
        function positionDefault() {
            if (completechange && tempstatus) {
                controls.autoRotate = false;
                controls.target = new THREE.Vector3(0, 0, 0);
                camera.position.x = 0;
                camera.position.y = 265;
                camera.position.z = 0;
            }
        }

        //改变plane
        var planetimeout;
        var direction = 'up';
        var changestatus = false;
        function changePlane() {
            if (!changestatus) {
                changestatus = true;
                planetimeout = setInterval(function () {
                    if (direction == 'down') {
                        plane.constant += 1;
                        if (plane.constant >= 36) {
                            $('#plane').css('background-image', "url('/static/imgs/new/first_clipping_up.png')");
                            $('#plane1').css('background-image', "url('/static/imgs/new/first_clipping_up.png')");
                            direction = 'up';
                            changestatus = false;
                            clearInterval(planetimeout);
                        }
                    }
                    if (direction == 'up') {
                        plane.constant -= 1;
                        if (plane.constant <= 11) {
                            $('#plane').css('background-image', "url('/static/imgs/new/first_clipping_down.png')");
                            $('#plane1').css('background-image', "url('/static/imgs/new/first_clipping_up.png')");
                            direction = 'down';
                            changestatus = false;
                            clearInterval(planetimeout);
                        }
                    }

                }, 10);
            }

        }

        //禁止所有按钮点击
        function buttonDisabled() {
            $('input').attr('disabled', 'true');
        }

        //还原所有按钮点击
        function buttonable() {
            $('input').removeAttr('disabled');
        }

        function stop() {
            $('#moveaudio')[0].pause();
            $('#moveaudio')[0].currentTime = 0.0;
        }

        function disshowhelp() {
            $('.Help').hide();
        }

        function satisfaction() {
            clearhouse();
            $('#forth').hide();
            $('#question').hide();
            $('#submit').show();
            $('#form').show();
        }

        function changemodify() {
            if (modify == 1) {
                clearhouse();
                $('#question').hide();
                $('#modify').css('background-image', "url('/static/imgs/new/forth_modify2_up.png')");
                $('#house_1').fadeIn(1000);
                modify = 2;
                return;
            }
            if (modify == 2) {
                clearhouse();
                $('#question').hide();
                $('#modify').css('background-image', "url('/static/imgs/new/forth_modify3_up.png')");
                $('#house_2').fadeIn(1000);
                modify = 3;
                return;
            }
            if (modify == 3) {
                clearhouse();
                $('#question').hide();
                $('#modify').css('background-image', "url('/static/imgs/new/forth_no_up.png')");
                $('#house_3').fadeIn(1000);
                modify = 4;
                return;
            }
            if (modify == 4) {
                clearhouse();
                satisfaction();
            }
        }

        function clearhouse() {
            $('#house_1').hide();
            $('#house_2').hide();
            $('#house_3').hide();
            $('#success').hide();
        }
        function addmessage() {
            var pattern = new RegExp(/^1[0-9]{10}$/)
            // console.log(pattern.test(trim($('#phone').val())));
            // console.log(trim($('#name').val()) != '');
            if (pattern.test(trim($('#phone').val())) && trim($('#name').val()) != '') {
                $.post("/message", { name: $('#name').val(), phone: $('#phone').val() }, function (data) {
                    // console.log(data)
                    if (data.status == 200) {
                        clearhouse();
                        $('#forth').hide();
                        $('#question').hide();
                        $('#submit').hide();
                        $('#form').hide();
                        $('#success').show();
                        $('#phone').val('');
                        $('#name').val('');
                    }

                });
            }
        }
        function patten() {
            // pattern="^1[0-9]{10}$"
            var patten = new RegExp(/[0-9]/)
            if (!patten.test($('#phone').val())) {
                $('#phone').val('');
            }
        }
        function trim(str) {
            var result;
            result = str.replace(/(^\s+)|(\s+$)/g, "");
            result = result.replace(/\s/g, "");
            return result;
        }
        
        // function shonotice() {
        //     if(!tempstatus){
        //         $('.notice').show();
        //         console.log(temptimeout==undefined);
        //         if(temptimeout==undefined){
        //             setTimeout(function(){
        //             $('.notice').hide();
        //         },3000);
        //         }
                
        //     }
        // }

    </script>
</body>

</html>